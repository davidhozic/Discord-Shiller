<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark">
    
    <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Changelog" href="changelog.html" /><link rel="prev" title="Functions" href="functions.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.06.21"/>
        <title>Logging - Discord Advert Framework documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?digest=40978830699223671f4072448e654b5958f38b89" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Discord Advert Framework  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  
  <span class="sidebar-brand-text">Discord Advert Framework  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="ref.html">Programming Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="classes.html">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="functions.html">Functions</a></li>
</ul>
</li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="logging">
<h1>Logging<a class="headerlink" href="#logging" title="Permalink to this headline">#</a></h1>
<p>The framework allows to log sent messages for each <a class="reference internal" href="classes.html#guild"><span class="std std-ref">GUILD</span></a>/<a class="reference internal" href="classes.html#user"><span class="std std-ref">USER</span></a> (if you set the “generate_log” to True inside the <a class="reference internal" href="classes.html#guild"><span class="std std-ref">GUILD</span></a> or <a class="reference internal" href="classes.html#user"><span class="std std-ref">USER</span></a> object).
There are 2 different types of logs:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#relational-database-log"><span class="std std-ref">Relational Database Log</span></a></p></li>
<li><p><a class="reference internal" href="#json-logging-file"><span class="std std-ref">JSON Logging (file)</span></a></p></li>
</ul>
<section id="relational-database-log">
<h2>Relational Database Log<a class="headerlink" href="#relational-database-log" title="Permalink to this headline">#</a></h2>
<div class="versionadded">
<p><span class="versionmodified added">New in version v1.9.</span></p>
</div>
<p>This type of logging enables saving logs to a remote server inside the database. Currently <strong>only Microsoft SQL server is supported.</strong>.
In addition to being smaller in size, database logging takes up less space and it allows easier data analysis.</p>
<section id="usage">
<h3>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">#</a></h3>
<p>To use a SQL base for logging, you need to pass the <a class="reference internal" href="functions.html#run"><span class="std std-ref">run</span></a> function with the sql_manager parameter and pass it the LoggerSQL object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">framework</span> <span class="k">as</span> <span class="nn">fw</span>

<span class="n">rolls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;https://i.pinimg.com/originals/b7/fb/80/b7fb80122cf46d0e584f3a0768aef282.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://bit.ly/3sHrjQZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://static.wikia.nocookie.net/a1dea591-8a10-4c02-a573-5321c601c129&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://www.gifcen.com/wp-content/uploads/2022/03/rickroll-gif-4.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://bit.ly/3u5D8Dt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://static1.squarespace.com/static/60503ac20951e15087fbe7b8/60504609ee9c445722c9dd4e/60e3f9b541eb1b01e8e46854/1627103366283/RalphRoll.gif?format=1500w&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://i.imgflip.com/56bhvt.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://www.youtube.com/watch?v=dQw4w9WgXcQ&quot;</span>
<span class="p">]</span>

<span class="nd">@fw</span><span class="o">.</span><span class="n">data_function</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">item</span>

<span class="n">servers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">fw</span><span class="o">.</span><span class="n">GUILD</span><span class="p">(</span>
        <span class="n">snowflake</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
        <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
            <span class="n">fw</span><span class="o">.</span><span class="n">TextMESSAGE</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">get</span><span class="p">(</span><span class="n">rolls</span><span class="o">.</span><span class="n">copy</span><span class="p">()),</span> <span class="p">[</span><span class="mi">12345</span><span class="p">],</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">logging</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
<span class="p">]</span>


<span class="n">fw</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">token</span><span class="o">=</span><span class="s2">&quot;OSDSJ44JNnnJNJ2NJDBWQUGHSHFAJSHDUQHFDBADVAHJVERAHGDVAHJSVDE&quot;</span><span class="p">,</span>                <span class="c1"># Example account token</span>
    <span class="n">is_user</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
    <span class="n">server_list</span><span class="o">=</span><span class="n">servers</span><span class="p">,</span>
    <span class="n">sql_manager</span><span class="o">=</span><span class="n">fw</span><span class="o">.</span><span class="n">LoggerSQL</span><span class="p">(</span><span class="s2">&quot;username&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">,</span> <span class="s2">&quot;server address&quot;</span><span class="p">,</span> <span class="s2">&quot;database name&quot;</span><span class="p">)</span> <span class="c1"># *Note: The database must be created manually,</span>
                                                                                        <span class="c1">#  everything else in the database is then created automatically</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="features">
<h3>Features<a class="headerlink" href="#features" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>Automatic creation of tables, procedures, functions, views, triggers</p></li>
<li><p>Caching for faster logging</p></li>
<li><p>Low redundancy for reduced file size</p></li>
<li><p>Automatic error recovery:</p>
<ul>
<li><p>Automatic reconnect on disconnect - Retries 3 times in delays of 5 minutes, then switches to file logging</p></li>
<li><p>If tables are deleted, they are automatically recreated</p></li>
<li><p>If cached values get corrupted, they are automatically re-cached</p></li>
<li><p>If there are un-recoverable errors, the framework switches to file logging</p></li>
</ul>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The database must already exist! However it can be completely empty, no need to manually create the schema.</p>
</div>
</section>
<section id="er-diagram-of-the-logs">
<h3>ER diagram of the logs<a class="headerlink" href="#er-diagram-of-the-logs" title="Permalink to this headline">#</a></h3>
<a class="reference internal image-reference" href="_images/er_diagram.png"><img alt="_images/er_diagram.png" src="_images/er_diagram.png" style="width: 500pt;" /></a>
</section>
<section id="tables">
<h3>Tables<a class="headerlink" href="#tables" title="Permalink to this headline">#</a></h3>
<section id="messagelog">
<h4>MessageLOG<a class="headerlink" href="#messagelog" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This table contains the actual logs of sent messages, if the message type is <a class="reference internal" href="classes.html#directmessage"><span class="std std-ref">DirectMESSAGE</span></a>, then all the information is stored in this table.
If the types are <strong>Voice/Text</strong> MESSAGE, then part of the log (to which channels it sent), is saved in the <a class="reference internal" href="#messagechannellog"><span class="std std-ref">MessageChannelLOG</span></a> table.</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>[Primary Key]</strong> id: int  - This is an internal ID of the log inside the database.</p></li>
<li><p>sent_data: int - Foreign key pointing to a row inside the <a class="reference internal" href="#datahistory"><span class="std std-ref">DataHISTORY</span></a> table.</p></li>
<li><p>message_type: int - Foreign key ID pointing to a entry inside the <a class="reference internal" href="#messagetype"><span class="std std-ref">MessageTYPE</span></a> table.</p></li>
<li><p>guild_id: int -  Foreign key pointing to <a class="reference internal" href="#guilduser"><span class="std std-ref">GuildUSER</span></a> table.</p></li>
<li><p>message_mode: int - Foreign key pointing to <a class="reference internal" href="#messagemode"><span class="std std-ref">MessageMODE</span></a> table. This is non-null only for <a class="reference internal" href="classes.html#directmessage"><span class="std std-ref">DirectMESSAGE</span></a>.</p></li>
<li><p>dm_reason: str -  If MessageTYPE is not DirectMESSAGE or the send attempt was successful, this is NULL, otherwise it contains the string representation of the error that caused the message send attempt to be unsuccessful.</p></li>
<li><p>timestamp: datetime - The timestamp of the message send attempt.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="datahistory">
<h4>DataHISTORY<a class="headerlink" href="#datahistory" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This table contains all the <strong>different</strong> data that was ever advertised. Every element is <strong>unique</strong> and is not replicated.
This table exist to reduce redundancy and file size of the logs whenever same data is advertised multiple times.
When a log is created, it is first checked if the data sent was already sent before, if it was the id to the existing <a class="reference internal" href="#datahistory"><span class="std std-ref">DataHISTORY</span></a> row is used,
else a new row is created.</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>[Primary Key]</strong> id: int - Internal ID of data inside the database.</p></li>
<li><p>content: str -  Actual data that was sent.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="messagetype">
<h4>MessageTYPE<a class="headerlink" href="#messagetype" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This is a lookup table containing the the different message types that exist within the framework (<a class="reference internal" href="classes.html#messages"><span class="std std-ref">Messages</span></a>).</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>[Primary Key]</strong> id: int - Internal ID of the message type inside the database.</p></li>
<li><p>name: str - The name of the actual message type.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="guilduser">
<h4>GuildUSER<a class="headerlink" href="#guilduser" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The table contains all the guilds/users the framework ever generated a log for.</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>[Primary Key]</strong> id: int - Internal ID of the Guild/User inside the database.</p></li>
<li><p>snowflake_id: int - The discord (snowflake) ID of the User/Guild</p></li>
<li><p>name: str - Name of the Guild/User</p></li>
<li><p>guild_type: int - Foreign key pointing to <a class="reference internal" href="#guildtype"><span class="std std-ref">GuildTYPE</span></a> table.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="messagemode">
<h4>MessageMODE<a class="headerlink" href="#messagemode" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This is a lookup table containing the the different message modes available by <a class="reference internal" href="classes.html#textmessage"><span class="std std-ref">TextMESSAGE</span></a> / <a class="reference internal" href="classes.html#directmessage"><span class="std std-ref">DirectMESSAGE</span></a>, it is set to null for <a class="reference internal" href="classes.html#voicemessage"><span class="std std-ref">VoiceMESSAGE</span></a>.</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>[Primary Key]</strong> id: int - Internal identifier of the message mode inside the database.</p></li>
<li><p>name: str - The name of the actual message mode.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="guildtype">
<h4>GuildTYPE<a class="headerlink" href="#guildtype" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This is a lookup table containing types of the guilds inside the framework (<a class="reference internal" href="classes.html#guilds-servers"><span class="std std-ref">Guilds (Servers)</span></a>).</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>[Primary Key]</strong> id: int -  Internal identifier of the guild type inside the database.</p></li>
<li><p>name: str - The name of the guild type.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="channel">
<h4>CHANNEL<a class="headerlink" href="#channel" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The table contains all the channels that the framework ever advertised into.</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>[Primary Key]</strong> id: int - Internal identifier of the channel inside the database</p></li>
<li><p>snowflake_id: int - The discord (snowflake) identifier representing specific channel</p></li>
<li><p>name: str - The name of the channel</p></li>
<li><p>guild_id: int - Foreign key pointing to a row inside the <a class="reference internal" href="#guilduser"><span class="std std-ref">GuildUSER</span></a> table. It points to a guild that the channel is part of.</p></li>
</ul>
</dd>
</dl>
</section>
<section id="messagechannellog">
<h4>MessageChannelLOG<a class="headerlink" href="#messagechannellog" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Since messages can send into multiple channels, each MessageLOG has multiple channels which
cannot be stored inside the <a class="reference internal" href="#messagelog"><span class="std std-ref">MessageLOG</span></a>.
This is why this table exists. It contains channels of each <a class="reference internal" href="#messagelog"><span class="std std-ref">MessageLOG</span></a>.</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>[Primary Key]</strong> <strong>[Foreign Key]</strong> log_id: int ~ Foreign key pointing to a row inside <a class="reference internal" href="#messagelog"><span class="std std-ref">MessageLOG</span></a> (to which log this channel log belongs to).</p></li>
<li><p><strong>[Primary Key]</strong> <strong>[Foreign Key]</strong> channel_id  ~ Foreign key pointing to a row inside the <a class="reference internal" href="#channel"><span class="std std-ref">CHANNEL</span></a> table.</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="sql-custom-data-types">
<h3>SQL custom data types<a class="headerlink" href="#sql-custom-data-types" title="Permalink to this headline">#</a></h3>
<p>This sections contains descriptions on all SQL data types that are user-defined.</p>
<section id="t-tmp-channel-log">
<h4>t_tmp_channel_log<a class="headerlink" href="#t-tmp-channel-log" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This is only used in the <a class="reference internal" href="#sp-save-log"><span class="std std-ref">sp_save_log</span></a> procedure to accept a list of channels it was attempted to send into and the reason for failure.
This is a custom table type that contains attributes:</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p>id: int ~ Internal DB id pointing to <a class="reference internal" href="#channel"><span class="std std-ref">CHANNEL</span></a> table.</p></li>
<li><p>reason: nvarchar ~ Reason why sending to the channel failed, if it was successful then this is NULL.</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="sql-stored-procedures-sp">
<h3>SQL Stored Procedures (SP)<a class="headerlink" href="#sql-stored-procedures-sp" title="Permalink to this headline">#</a></h3>
<p>This section contains the description on all the saved procedures inside the SQL database.</p>
<section id="sp-save-log">
<h4>sp_save_log<a class="headerlink" href="#sp-save-log" title="Permalink to this headline">#</a></h4>
<div class="highlight-t-sql notranslate"><div class="highlight"><pre><span></span><span class="n">sp_save_log</span><span class="p">(</span><span class="nv">@sent_data</span><span class="w"> </span><span class="nc">nvarchar</span><span class="p">(</span><span class="nf">max</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="nv">@message_type</span><span class="w"> </span><span class="nc">smallint</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nv">@guild_id</span><span class="w"> </span><span class="nc">int</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nv">@message_mode</span><span class="w"> </span><span class="nc">smallint</span><span class="p">,</span><span class="w"></span>
<span class="w">        </span><span class="nv">@dm_reason</span><span class="w"> </span><span class="nc">nvarchar</span><span class="p">(</span><span class="nf">max</span><span class="p">),</span><span class="w"></span>
<span class="w">        </span><span class="nv">@channels</span><span class="w"> </span><span class="n">t_tmp_channel_log</span><span class="w"> </span><span class="n">READONLY</span><span class="w"></span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This procedure is used by the SQL python module to store the log instead of using SQLAlchemy for faster saving speed.</p>
</dd>
<dt class="field-even">Attributes</dt>
<dd class="field-even"><ul class="simple">
<li><p>sent_data: nvarchar -  The data that was sent (jsonized).</p></li>
<li><p>message_type: smallint - Internal DB id that points to <a class="reference internal" href="#messagetype"><span class="std std-ref">MessageTYPE</span></a> table.</p></li>
<li><p>guild_id: int ~ Internal DB id that points to <a class="reference internal" href="#guilduser"><span class="std std-ref">GuildUSER</span></a> table.</p></li>
<li><p>message_mode: smallint - Internal DB id that points to <a class="reference internal" href="#messagemode"><span class="std std-ref">MessageMODE</span></a> table.</p></li>
<li><p>dm_reason: nvarchar -  This can only be different from NULL if the type of message is DirectMESSAGE. In the case that the message type is <a class="reference internal" href="classes.html#directmessage"><span class="std std-ref">DirectMESSAGE</span></a>, then this attribute is different from NULL when the send attempt failed, if send attempt succeeded, then this is NULL.</p></li>
<li><p>channels: <a class="reference internal" href="#t-tmp-channel-log"><span class="std std-ref">t_tmp_channel_log</span></a> ~ Table Valued Parameter (TVP) - Holds channels it was advertised into, if message type is DirectMESSAGE, this is an empty table.</p></li>
</ul>
</dd>
</dl>
</section>
</section>
<section id="sql-user-defined-functions-udf">
<h3>SQL User Defined Functions (UDF)<a class="headerlink" href="#sql-user-defined-functions-udf" title="Permalink to this headline">#</a></h3>
<p>This section contains the description on all user defined functions inside the SQL database.</p>
<section id="fn-log-success-rate">
<h4>fn_log_success_rate<a class="headerlink" href="#fn-log-success-rate" title="Permalink to this headline">#</a></h4>
<div class="highlight-t-sql notranslate"><div class="highlight"><pre><span></span><span class="n">fn_log_success_rate</span><span class="p">(</span><span class="nv">@log_id</span><span class="w"> </span><span class="nc">int</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This UDF can only be used for logs that have channels, so logs that originated from <a class="reference internal" href="classes.html#textmessage"><span class="std std-ref">TextMESSAGE</span></a> or <a class="reference internal" href="classes.html#voicemessage"><span class="std std-ref">VoiceMESSAGE</span></a>. The UDF calculates relative success of sent channels for a specific log entry (successful channels / all channels) which is a number between 0 and 1, 0 meaning no channels succeeded and 1 meaning all channels succeeded.</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p>log_id: int - The DB id of a certain log that is inside the database.</p></li>
</ul>
</dd>
<dt class="field-odd">Return</dt>
<dd class="field-odd"><p>The UDF returns the success rate - a number of type <code class="docutils literal notranslate"><span class="pre">decimal</span></code> with 5 decimals of precision.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the log_id is an id of a message log that has no channels, the UDF will return 1.</p>
</div>
</section>
<section id="fn-guilduser-success-rate">
<h4>fn_guilduser_success_rate<a class="headerlink" href="#fn-guilduser-success-rate" title="Permalink to this headline">#</a></h4>
<div class="highlight-t-sql notranslate"><div class="highlight"><pre><span></span><span class="n">fn_log_success_rate</span><span class="p">(</span><span class="nv">@snowflake_id</span><span class="w"> </span><span class="nc">bigint</span><span class="p">,</span><span class="w"> </span><span class="nv">@limit</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1000</span><span class="p">)</span><span class="w"></span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>This UDF returns relative success rate for specific GUILD/USER based on the last few logs.
Success rate is defined as (number of <strong>fully</strong> successful send attempts) / (number of all send attempts)</p>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p>snowflake_id: bigint ~ Discord’s ID (snowflake id) of the USER or GUILD you want to get the success rate for</p></li>
<li><p>limit: int ~ How many of the latest logs you want to use to calculate the relative success rate</p></li>
</ul>
</dd>
<dt class="field-odd">Return</dt>
<dd class="field-odd"><p>The UDF returns the success rate ~ a number of type <code class="docutils literal notranslate"><span class="pre">decimal</span></code> with 5 decimals of precision.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If no logs exist for specific GUILD/USER, 1 is returned.</p>
</div>
</section>
</section>
<section id="views">
<h3>Views<a class="headerlink" href="#views" title="Permalink to this headline">#</a></h3>
<p>This section contains the description on all views inside the SQL database.</p>
<section id="vmessagelogfulldetail">
<h4>vMessageLogFullDETAIL<a class="headerlink" href="#vmessagelogfulldetail" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>The <a class="reference internal" href="#messagelog"><span class="std std-ref">MessageLOG</span></a> table contains mostly internal DB ids which makes it hard to see anything directly from it. This is why the <a class="reference internal" href="#vmessagelogfulldetail"><span class="std std-ref">vMessageLogFullDETAIL</span></a> view exists. It contains all the information inside the MessageLOG table, but expanded with actual values and not just IDs making it easier to view the content of the log.</p>
</dd>
</dl>
</section>
</section>
<section id="triggers">
<h3>Triggers<a class="headerlink" href="#triggers" title="Permalink to this headline">#</a></h3>
<p>This section contains the description on all the triggers inside the SQL database.</p>
<section id="tr-delete-msg-log">
<h4>tr_delete_msg_log<a class="headerlink" href="#tr-delete-msg-log" title="Permalink to this headline">#</a></h4>
<dl class="field-list simple">
<dt class="field-odd">Description</dt>
<dd class="field-odd"><p>Entries in <a class="reference internal" href="#messagechannellog"><span class="std std-ref">MessageChannelLOG</span></a> get deleted if an entry inside <a class="reference internal" href="#messagelog"><span class="std std-ref">MessageLOG</span></a> gets deleted due to the <a class="reference internal" href="#messagechannellog"><span class="std std-ref">MessageChannelLOG</span></a> table having a cascading foreign key pointing to the <a class="reference internal" href="#messagelog"><span class="std std-ref">MessageLOG</span></a> table. However reverse is not the same, the <a class="reference internal" href="#messagelog"><span class="std std-ref">MessageLOG</span></a> table does not have anything pointing to the <a class="reference internal" href="#messagechannellog"><span class="std std-ref">MessageChannelLOG</span></a> table meaning that cascading based on foreign keys is not possible.
This trigger’s job is to delete an entry inside the MessageLOG when all the entries in <a class="reference internal" href="#messagechannellog"><span class="std std-ref">MessageChannelLOG</span></a> referencing it get deleted.</p>
</dd>
</dl>
</section>
</section>
</section>
<section id="json-logging-file">
<h2>JSON Logging (file)<a class="headerlink" href="#json-logging-file" title="Permalink to this headline">#</a></h2>
<p>The logs are written in the JSON format and saved into a JSON file, that has the name of the guild or an user you were sending messages into.
The JSON files are fragmented by day and stored into folder <code class="docutils literal notranslate"><span class="pre">Year/Month/Day</span></code>, this means that each day a new JSON file will be generated for that specific day for easier managing,
for example, if today is <code class="docutils literal notranslate"><span class="pre">13.07.2022</span></code>, the log will be saved into the file that is located in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>History
└───2022
│   └───07
│       └───13
|           └─── #David&#39;s dungeon.json
</pre></div>
</div>
<section id="code-example">
<h3>Code Example<a class="headerlink" href="#code-example" title="Permalink to this headline">#</a></h3>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Code to produce JSON logs</span><a class="headerlink" href="#id1" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">framework</span> <span class="k">as</span> <span class="nn">fw</span>

<span class="n">rolls</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;https://i.pinimg.com/originals/b7/fb/80/b7fb80122cf46d0e584f3a0768aef282.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://bit.ly/3sHrjQZ&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://static.wikia.nocookie.net/a1dea591-8a10-4c02-a573-5321c601c129&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://www.gifcen.com/wp-content/uploads/2022/03/rickroll-gif-4.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://bit.ly/3u5D8Dt&quot;</span><span class="p">,</span>
    <span class="s2">&quot;http://static1.squarespace.com/static/60503ac20951e15087fbe7b8/60504609ee9c445722c9dd4e/60e3f9b541eb1b01e8e46854/1627103366283/RalphRoll.gif?format=1500w&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://i.imgflip.com/56bhvt.gif&quot;</span><span class="p">,</span>
    <span class="s2">&quot;https://www.youtube.com/watch?v=dQw4w9WgXcQ&quot;</span>
<span class="p">]</span>

<span class="nd">@fw</span><span class="o">.</span><span class="n">data_function</span>
<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">st</span><span class="p">):</span>
    <span class="n">item</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">st</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">item</span>

<span class="n">servers</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">fw</span><span class="o">.</span><span class="n">GUILD</span><span class="p">(</span>
        <span class="n">snowflake</span><span class="o">=</span><span class="mi">12345</span><span class="p">,</span>
        <span class="n">messages</span><span class="o">=</span><span class="p">[</span>
            <span class="n">fw</span><span class="o">.</span><span class="n">TextMESSAGE</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">get</span><span class="p">(</span><span class="n">rolls</span><span class="o">.</span><span class="n">copy</span><span class="p">()),</span> <span class="p">[</span><span class="mi">12345</span><span class="p">],</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
        <span class="p">],</span>
        <span class="n">logging</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)</span>
<span class="p">]</span>


<span class="n">fw</span><span class="o">.</span><span class="n">run</span><span class="p">(</span>
    <span class="n">token</span><span class="o">=</span><span class="s2">&quot;OSDSJ44JNnnJNJ2NJDBWQUGHSHFAJSHDUQHFDBADVAHJVERAHGDVAHJSVDE&quot;</span><span class="p">,</span>   <span class="c1"># Example account token</span>
    <span class="n">is_user</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> 
    <span class="n">server_list</span><span class="o">=</span><span class="n">servers</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="example-of-a-log">
<h3>Example of a log<a class="headerlink" href="#example-of-a-log" title="Permalink to this headline">#</a></h3>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">JSON file log</span><a class="headerlink" href="#id2" title="Permalink to this code">#</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">David&#39;s dungeon&quot;</span><span class="p">,</span>
    <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">863071397207212052</span><span class="p">,</span>
    <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;GUILD&quot;</span><span class="p">,</span>
    <span class="s2">&quot;message_history&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;sent_data&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;https://i.imgflip.com/56bhvt.gif&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;successful&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">978332728615378984</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;failed&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">},</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TextMESSAGE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;23.05.2022 18:28:15&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;sent_data&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;http://static1.squarespace.com/static/60503ac20951e15087fbe7b8/60504609ee9c445722c9dd4e/60e3f9b541eb1b01e8e46854/1627103366283/RalphRoll.gif?format=1500w&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;successful&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">978332728615378984</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;failed&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">},</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TextMESSAGE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;23.05.2022 18:28:09&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;sent_data&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;https://bit.ly/3u5D8Dt&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;successful&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">978332728615378984</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;failed&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">},</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TextMESSAGE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;23.05.2022 18:28:04&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;sent_data&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;https://www.gifcen.com/wp-content/uploads/2022/03/rickroll-gif-4.gif&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;successful&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">978332728615378984</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;failed&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">},</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TextMESSAGE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;23.05.2022 18:27:59&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;sent_data&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;https://static.wikia.nocookie.net/a1dea591-8a10-4c02-a573-5321c601c129&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;successful&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">978332728615378984</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;failed&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">},</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TextMESSAGE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;23.05.2022 18:27:54&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;sent_data&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;https://bit.ly/3sHrjQZ&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;successful&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">978332728615378984</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;failed&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">},</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TextMESSAGE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;23.05.2022 18:27:49&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;sent_data&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;text&quot;</span><span class="p">:</span> <span class="s2">&quot;https://i.pinimg.com/originals/b7/fb/80/b7fb80122cf46d0e584f3a0768aef282.gif&quot;</span>
            <span class="p">},</span>
            <span class="s2">&quot;channels&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;successful&quot;</span><span class="p">:</span> <span class="p">[</span>
                    <span class="p">{</span>
                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;sp&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="mi">978332728615378984</span>
                    <span class="p">}</span>
                <span class="p">],</span>
                <span class="s2">&quot;failed&quot;</span><span class="p">:</span> <span class="p">[]</span>
            <span class="p">},</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;TextMESSAGE&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;index&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="s2">&quot;23.05.2022 18:27:44&quot;</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="changelog.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Changelog</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="functions.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Functions</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, David Hozic
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Logging</a><ul>
<li><a class="reference internal" href="#relational-database-log">Relational Database Log</a><ul>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#features">Features</a></li>
<li><a class="reference internal" href="#er-diagram-of-the-logs">ER diagram of the logs</a></li>
<li><a class="reference internal" href="#tables">Tables</a><ul>
<li><a class="reference internal" href="#messagelog">MessageLOG</a></li>
<li><a class="reference internal" href="#datahistory">DataHISTORY</a></li>
<li><a class="reference internal" href="#messagetype">MessageTYPE</a></li>
<li><a class="reference internal" href="#guilduser">GuildUSER</a></li>
<li><a class="reference internal" href="#messagemode">MessageMODE</a></li>
<li><a class="reference internal" href="#guildtype">GuildTYPE</a></li>
<li><a class="reference internal" href="#channel">CHANNEL</a></li>
<li><a class="reference internal" href="#messagechannellog">MessageChannelLOG</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sql-custom-data-types">SQL custom data types</a><ul>
<li><a class="reference internal" href="#t-tmp-channel-log">t_tmp_channel_log</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sql-stored-procedures-sp">SQL Stored Procedures (SP)</a><ul>
<li><a class="reference internal" href="#sp-save-log">sp_save_log</a></li>
</ul>
</li>
<li><a class="reference internal" href="#sql-user-defined-functions-udf">SQL User Defined Functions (UDF)</a><ul>
<li><a class="reference internal" href="#fn-log-success-rate">fn_log_success_rate</a></li>
<li><a class="reference internal" href="#fn-guilduser-success-rate">fn_guilduser_success_rate</a></li>
</ul>
</li>
<li><a class="reference internal" href="#views">Views</a><ul>
<li><a class="reference internal" href="#vmessagelogfulldetail">vMessageLogFullDETAIL</a></li>
</ul>
</li>
<li><a class="reference internal" href="#triggers">Triggers</a><ul>
<li><a class="reference internal" href="#tr-delete-msg-log">tr_delete_msg_log</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#json-logging-file">JSON Logging (file)</a><ul>
<li><a class="reference internal" href="#code-example">Code Example</a></li>
<li><a class="reference internal" href="#example-of-a-log">Example of a log</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/scripts/furo.js"></script>
    <script src="_static/tabs.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    </body>
</html>